/**
 * Component styling for the DING Online interface.
 */
.btn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.07);
      color:var(--text);
      padding:10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:700;
      transition:.12s transform, .12s background, .12s border;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.10)}
    .btn:active{transform: translateY(0px)}
    .btn.primary{background: rgba(124,92,255,.22); border-color: rgba(124,92,255,.55)}
    .btn.primary:hover{background: rgba(124,92,255,.28)}
    .btn.danger{background: rgba(255,92,122,.18); border-color: rgba(255,92,122,.45)}
    .btn.good{background: rgba(62,226,138,.18); border-color: rgba(62,226,138,.45)}
    .btn.swap{background: rgba(246,196,83,.18); border-color: rgba(246,196,83,.45)}
    .btn:disabled{opacity:.45; cursor:not-allowed; transform:none}
    .startActions{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .voteStartBlock{
      display:flex;
      flex-direction:column;
      gap:4px;
      align-items:flex-start;
    }
    .voteStartStatus{ font-size:12px; }
    #startGameBtn{
      font-size:16px;
      font-weight:900;
      letter-spacing:.3px;
      padding:14px 16px;
      background: linear-gradient(135deg, rgba(124,92,255,.38), rgba(62,226,138,.18));
      border-color: rgba(124,92,255,.75);
      box-shadow: 0 14px 32px rgba(124,92,255,.2), 0 8px 20px rgba(0,0,0,.35);
    }
    #startGameBtn:hover{
      background: linear-gradient(135deg, rgba(124,92,255,.48), rgba(62,226,138,.26));
      transform: translateY(-2px);
    }
    @media (max-width: 640px){
      .startActions{ align-items:stretch; }
      #startGameBtn{ width:100%; font-size:16px; }
      #voteStartBtn{ width:100%; }
      .voteStartBlock{ width:100%; }
    }
    .stack{display:flex; flex-direction:column; gap:10px;}
    .small{font-size:13px; color:var(--muted)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;}
    .scoreboard{
      display:flex; flex-direction:column; gap:6px;
      --trickChipW: clamp(20px, 7vw, 38px);
      --trickChipH: clamp(28px, 9vw, 52px);
      --trickChipGap: clamp(4px, 1.5vw, 8px);
      --trickChipRadius: clamp(6px, 2vw, 8px);
      --trickInnerFont: clamp(11px, 3.4vw, 16px);
      --trickInnerRadius: clamp(4px, 1.6vw, 6px);
    }
    .playerRow{
      display:flex; align-items:flex-start; justify-content:space-between; gap:16px;
      padding:10px 12px;
      border:1px solid var(--stroke);
      border-radius: 14px;
      background: rgba(0,0,0,.18);
      min-height:0;
      flex-wrap:wrap;
    }
    .playerRow > div:first-child{
      flex: 1 1 220px;
      min-width: 0;
      max-width: 100%;
    }
    .playerRow .name{font-weight:800}
    .playerInfo{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .playerRow .badge{
      padding:4px 6px;
      font-size:11px;
    }
    .playerTop{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .playerMeta{
      display:flex;
      align-items:center;
      gap:8px;
      margin-top:auto;
    }
    .scoreRow{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .scoreRowSplit{
      justify-content:space-between;
      flex-wrap:nowrap;
    }
    .scoreRowSplit .trickVisualizer{ flex:1 1 auto; min-width:0; }
    .scoreRowSplit .totalScore{ margin-left:auto; }
    .badge{
      padding:6px 8px; border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      font-size:12px; color:var(--muted);
      display:flex; gap:6px; align-items:center;
    }
    .badge strong{color:var(--text)}
    .tableArea{
      display:flex; flex-direction:column; gap:12px;
      padding-bottom:16px;
      position:relative;
    }
    .tableHint{
      text-align:center;
      font-size:13px;
      color:var(--muted);
      margin-top:-4px;
    }
    .swapSummary{
      display:none;
      flex-direction:column;
      gap:8px;
      padding:10px 12px;
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
    }
    .swapSummary.show{ display:flex; }
    .swapSummaryTitle{
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.6px;
      font-weight:800;
      color:var(--muted);
    }
    .swapSummaryList{
      display:grid;
      gap:6px;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    }
    .swapSummaryItem{
      padding:6px 8px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
      font-size:12px;
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .swapAnnouncement{
      position:absolute;
      left:50%;
      top:10px;
      transform: translateX(-50%);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
      padding:10px 14px;
      border:1px solid var(--stroke);
      border-radius:14px;
      background: rgba(8,12,24,.92);
      box-shadow: var(--shadow);
      opacity:0;
      pointer-events:none;
      z-index: 5;
    }
    .swapAnnouncement.show{
      opacity:1;
      animation: swapAnnounceIn .32s ease-out forwards;
    }
    .swapAnnouncement.exit{
      animation: swapAnnounceOut .42s ease-in forwards;
    }
    .swapCardRow{
      display:flex;
      gap:6px;
      align-items:center;
      justify-content:center;
      min-height:28px;
    }
    .swapGhostCard{
      width:20px;
      height:28px;
      border-radius:4px;
      border:1px solid rgba(255,255,255,.2);
      background: linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.04));
      box-shadow: 0 8px 16px rgba(0,0,0,.28);
      opacity:.9;
      animation: swapGhostFly .7s ease-out forwards;
      transform: translate3d(0,0,0) rotate(0deg);
    }
    .swapAnnouncementText{
      font-size:12px;
      color:var(--text);
      text-align:center;
    }
    @keyframes swapGhostFly{
      0%{ transform: translate3d(0,0,0) rotate(0deg); opacity:0; }
      30%{ opacity:.95; }
      100%{ transform: translate3d(var(--ghost-x, 0px), var(--ghost-y, -120px), 0) rotate(var(--ghost-rot, 0deg)); opacity:0; }
    }
    @keyframes swapAnnounceIn{
      from{ transform: translateX(-50%) translateY(8px); opacity:0; }
      to{ transform: translateX(-50%) translateY(0); opacity:1; }
    }
    @keyframes swapAnnounceOut{
      from{ transform: translateX(-50%) translateY(0); opacity:1; }
      to{ transform: translateX(-50%) translateY(-12px); opacity:0; }
    }
    .trickArea{
      display:flex; flex-direction:column; gap:10px; align-items:stretch;
    }
    .trickInfoRow{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:center;
    }
    .trickPlayRow{
      display:flex; gap:10px; flex-wrap:wrap; align-items:stretch; justify-content:center;
    }
    .trickCard{
      min-width: 200px;
      flex: 1 1 200px;
      border:1px solid var(--stroke);
      border-radius: 16px;
      padding:12px;
      background: rgba(0,0,0,.18);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .cardFace{
      width: var(--cardW);
      height: 96px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.06));
      display:flex; flex-direction:column; justify-content:space-between;
      padding:10px;
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
      backface-visibility: hidden;
      transform: translateZ(0);
    }
    .cardFace .top{font-weight:900; font-size:14px}
    .cardFace .mid{font-size:20px; text-align:center}
    .cardFace .bot{font-weight:900; font-size:14px; text-align:right}
    .red{color:#ff7c95}
    .hand{
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:flex-end;
    }
    .cardBtn{
      width: var(--cardW);
      height: calc(var(--cardW) * 1.45);
      border-radius:10px;
      position: relative;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
      padding:10px;
      cursor:pointer;
      display:flex; flex-direction:column; justify-content:space-between;
      transition: .12s transform, .12s border, .12s background;
      user-select:none;
      backface-visibility: hidden;
      transform: translateZ(0);
    }
    .cardBtn.dealHidden{
      opacity:0;
      pointer-events:none;
      transform: translateY(8px);
    }
    .cardBtn:hover{transform: translateY(-2px); border-color: rgba(124,92,255,.7)}
    .cardBtn.selected{
      transform: translateY(-6px);
      border-color: rgba(62,226,138,.8);
      background: linear-gradient(180deg, rgba(62,226,138,.16), rgba(255,255,255,.05));
    }
    .cardBtn.disabled{
      opacity:.38; cursor:not-allowed; transform:none;
      border-color: rgba(255,255,255,.14);
    }
    /* gold outline for trump cards in-hand */
    .cardBtn.trump{ border-color: rgba(252,204,102,.55); box-shadow: 0 12px 28px rgba(252,204,102,.06); }

    /* Table trick slot layout: card on top, player name underneath */
    .trickSlot{ display:flex; flex-direction:column; align-items:center; gap:6px; min-width: var(--cardW); }
    /* Table card faces are slightly larger and styled differently than in-hand cards */
    .trickSlot .cardFace{ width: var(--cardW); height: calc(var(--cardW) * 1.45); border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.12); }
    .trickSlot .cardFace.enter{ animation: trickIn 360ms cubic-bezier(.2,.9,.2,1); will-change: transform, opacity; }
    @keyframes trickIn{
      0%{ transform: translate3d(0,-12px,0) scale(.98); opacity:0 }
      100%{ transform: translate3d(0,0,0) scale(1); opacity:1 }
    }
    .cardBtn .top,.cardBtn .bot{font-weight:900; font-size:14px}
    .cardBtn .bot{ text-align:right; }
    .cardBtn .mid{font-size:20px; text-align:center}
    .row2{display:flex; gap:10px; flex-wrap:wrap;}
    #tablePanel .row2{ justify-content:center; }
    .menuWrap{ position:relative; }
    .menu{
      position:absolute;
      top: calc(100% + 6px);
      right: 0;
      min-width: 180px;
      background: rgba(12,16,26,.96);
      border:1px solid var(--stroke);
      border-radius: 12px;
      box-shadow: 0 16px 40px rgba(0,0,0,.45);
      display:none;
      flex-direction:column;
      padding:6px;
      z-index: 50;
      backdrop-filter: blur(10px);
    }
    .menu.open{ display:flex; }
    .playerMenu{
      position: fixed;
      top: auto;
      left: 0;
      right: auto;
      display: none;
      z-index: 120;
    }
    .playerMenu.open{ display:flex; }
    .menuItem{
      width:100%;
      text-align:left;
      background: transparent;
      border:none;
      color: var(--text);
      padding:8px 10px;
      border-radius: 10px;
      font-size:13px;
      cursor:pointer;
    }
    .menuItem:hover{ background: rgba(255,255,255,.06); }
    .menuItem.danger{ color:#ff9cb1; }
    .menuItem:disabled{ opacity:.45; cursor:not-allowed; }
    .menuDivider{
      height:1px;
      margin:4px 6px;
      background: rgba(255,255,255,.12);
    }
    .menuField{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding:6px;
    }
    .menuField .input{
      font-size:13px;
      padding:8px 10px;
    }
    .menuField .btn{
      width:100%;
      font-size:13px;
      padding:8px 10px;
    }
    .headerTapZone{
      position:absolute;
      top:8px;
      right:8px;
      width:36px;
      height:36px;
      opacity:0;
      pointer-events:auto;
    }
    .footerDebug{
      position:fixed;
      left:10px;
      right:10px;
      bottom:8px;
      display:flex;
      flex-direction:column;
      gap:6px;
      z-index: 20;
      pointer-events:none;
    }
    .commitHash{
      font-size:11px;
      color:var(--muted);
      opacity:.7;
      letter-spacing:.2px;
    }
    .debugLog{
      display:none;
      max-height:180px;
      overflow:auto;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.35);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size:11px;
      color:var(--text);
      pointer-events:auto;
      white-space:pre-wrap;
    }
    .tableChips{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      flex-wrap:nowrap;
      overflow-x:auto;
      max-width:100%;
      min-width:0;
      padding-bottom:2px;
      scroll-behavior:smooth;
      scrollbar-width: thin;
      -webkit-overflow-scrolling: touch;
    }
    .tableChips .badge{ flex: 0 0 auto; }
    .input{
      width:100%;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.18);
      color: var(--text);
      outline:none;
    }
    .error{
      border:1px solid rgba(255,92,122,.55);
      background: rgba(255,92,122,.10);
      color: #ffd6de;
      padding:10px 12px;
      border-radius: 14px;
    }
    .lock{
      position:fixed; inset:0;
      background: rgba(6,8,16,.86);
      backdrop-filter: blur(10px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:999;
      padding: 16px;
    }
    .lock .box{
      max-width: 520px; width:100%;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border:1px solid var(--stroke);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 16px;
    }
    .lock h2{margin:0 0 8px 0}
    .lock p{margin:0 0 12px 0; color:var(--muted)}
    .footerNote{margin-top:10px; color:var(--muted); font-size:12px}

    /* Card log (crude) */
    .cardLog{
      border:1px dashed var(--stroke);
      padding:8px;
      border-radius:12px;
      background: rgba(255,255,255,.02);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size:12px;
      color:var(--muted);
    }
    .cardLog div{ margin:6px 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .foldedBadge{ padding:4px 8px; border-radius:999px; background: rgba(255,255,255,.03); color:var(--muted); font-size:12px; border:1px dashed var(--stroke); display:inline-block; margin-left:6px; }

    /* More thoughtful folded pill used in table and scoreboard */
    .foldedPill{
      display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      border: 1px solid rgba(255,255,255,.04); color:var(--muted); font-size:12px;
      box-shadow: none;
    }

    .collapseBtn{ padding:6px 8px; font-size:12px; display:none; }
    .panel.collapsed .bd{ display:none; }

    /* Header caret on the left */
    .panel .hd .caret{
      display:inline-block; width:14px; text-align:center; margin-right:8px; font-size:13px; opacity:.9; transition: transform .12s ease, opacity .12s ease;
      transform-origin: center;
    }
    .panel .hd .caret.collapsed{ transform: rotate(-90deg); opacity:.8; }
    .panel .hd:focus{ outline: 2px solid rgba(124,92,255,.12); outline-offset: 2px; border-radius: 12px; }

    /* Hide carets for non-collapsible sections */
    #tableCaret, #handCaret{ display:none; }

    /* hand hint spacing */
    #handHint{ margin-bottom:14px; }

    /* Mini card stack for won tricks */
    .wonTrick{ display:inline-block; position:relative; height:72px; margin-right:12px; }
    .miniCard{ width:40px; height:56px; border-radius:6px; border:1px solid rgba(255,255,255,.12); background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); display:flex; align-items:center; justify-content:center; font-size:13px; color:var(--muted); box-shadow: 0 6px 12px rgba(0,0,0,.25); }
    .miniCard.red{ color:#ff7c95 }
    .miniCard.winner{ border-color: rgba(124,92,255,.6); background: linear-gradient(180deg, rgba(124,92,255,.12), rgba(255,255,255,.02)); color:var(--text); }
    /* Styled pill for the trick winner summary */
    .pill.trick-winner{
      padding:8px 12px;
      border-radius:12px;
      background: linear-gradient(90deg, rgba(124,92,255,.14), rgba(62,226,138,.06));
      border: 1px solid rgba(255,255,255,.06);
      box-shadow: 0 8px 30px rgba(124,92,255,.06), inset 0 1px 0 rgba(255,255,255,.02);
      color: var(--text);
      gap:12px;
      align-items:center;
      backface-visibility: hidden;
      transform: translateZ(0);
    }
    .pill.trick-winner .miniCard{ width:48px; height:56px; font-size:14px; border-radius:8px; }
    .pill.trick-winner .label{ color:var(--muted); font-size:12px; }
    .pill.trick-winner strong{ font-size:15px; }
    .pill.trick-winner.trickWinnerHero{
      position: relative;
      z-index: 40;
      transform-origin: center;
      will-change: transform;
    }
    .pill.trick-winner.trickWinnerReturn{
      transition: transform 650ms cubic-bezier(.2,.9,.2,1);
    }

    /* Mini trick counter in scoreboard */
    .trickVisualizer{ display:flex; gap:8px; align-items:center; flex-wrap:nowrap; min-width:0; }
    .trickChipsRow{ display:flex; gap:var(--trickChipGap); align-items:center; flex-wrap:nowrap; }
    /* treat each chip like a tiny card */
    .trickChip{
      width:var(--trickChipW); height:var(--trickChipH); border-radius:var(--trickChipRadius);
      border:1px solid rgba(255,255,255,.06);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.005));
      box-shadow: 0 8px 18px rgba(0,0,0,.32);
      display:flex; align-items:center; justify-content:center;
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .trickChip.empty{ opacity:.28; background: linear-gradient(180deg, rgba(255,255,255,.01), rgba(255,255,255,.005)); }
    /* gold-filled mini-card for won tricks */
    .trickChip.filled{
      background: linear-gradient(180deg, #fbf6e3, #f7e9b8);
      border:1px solid rgba(255,230,150,.25);
      box-shadow: 0 10px 28px rgba(245,200,80,.12), inset 0 1px 0 rgba(255,255,255,.6);
    }
    .trickChip.filled .chipInner{
      width:86%; height:78%; border-radius:var(--trickInnerRadius); display:flex; align-items:center; justify-content:center; font-size:var(--trickInnerFont); color:#6b4300;
      background: linear-gradient(180deg, rgba(255,235,160,.98), rgba(255,205,90,.98));
      box-shadow: 0 6px 14px rgba(204,150,26,.12) inset;
    }
    /* subtle lateral shake for the most-recent chip (light, tasteful) */
    .trickChip.recent{ transform: translateY(0); box-shadow: 0 20px 40px rgba(245,190,40,.14); animation: subtleShake 900ms ease-in-out infinite; }
    @keyframes subtleShake{
      0% { transform: translate3d(0,0,0) rotate(0deg); }
      20% { transform: translate3d(-2px,0,0) rotate(-0.6deg); }
      40% { transform: translate3d(1.5px,0,0) rotate(0.4deg); }
      60% { transform: translate3d(-1px,0,0) rotate(-0.3deg); }
      80% { transform: translate3d(0.6px,0,0) rotate(0.2deg); }
      100% { transform: translate3d(0,0,0) rotate(0deg); }
    }

    /* total score pill: bold gold display that stands out */
    .totalScore{
      display:flex; align-items:center; justify-content:center; min-width:80px; padding:8px 10px; gap:8px;
      background: linear-gradient(180deg, #fff7e6, #ffe59e);
      border: 1px solid rgba(255,210,110,.25);
      border-radius: 14px; color: #6b3f00; font-weight:900; box-shadow: 0 18px 44px rgba(245,190,40,.12), inset 0 1px 0 rgba(255,255,255,.6);
      transition: transform .18s ease, box-shadow .18s ease;
      font-size:13px;
      text-align:center;
      flex: 0 0 auto;
      margin-left: auto;
    }
    .totalScore .scoreValue{ font-size:16px; margin-left:4px; color:#4a2d00; }
    .totalScore.pulse{ animation: scorePulse 2400ms ease-in-out infinite; }
    @keyframes scorePulse{
      0% { box-shadow: 0 14px 36px rgba(245,190,40,.08); transform: translateY(0); }
      50% { box-shadow: 0 26px 60px rgba(245,170,30,.14); transform: translateY(-2px); }
      100% { box-shadow: 0 14px 36px rgba(245,190,40,.08); transform: translateY(0); }
    }
    /* deck visualizer removed */
    /* scoreboard highlights */
    .playerRow.activeTurn{ border-color: rgba(124,92,255,.45); box-shadow: 0 12px 30px rgba(124,92,255,.06); }
    .dealerBadge{ padding:4px 8px; border-radius:8px; background: rgba(255,215,130,.06); color:#ffdca8; font-size:12px; border:1px solid rgba(255,215,130,.06); margin-left:6px; }
    .hostBadge{
      padding:4px 10px;
      border-radius:999px;
      background: rgba(180,190,205,.16);
      color:#f1f4ff;
      font-size:11px;
      border:1px solid rgba(180,190,205,.3);
      margin-left:6px;
      font-weight:700;
    }
    .roomBadgeRow .hostBadge{ margin-left:0; }
    .turnDot{ color: var(--good); font-size:14px; margin-right:4px; font-weight:900; }
    /* raise the top-most mini-card more so it doesn't cover lower card text */
    .wonTrick .miniCard:last-child{ transform: translateY(-28px); z-index:2; box-shadow: 0 14px 24px rgba(0,0,0,.4); }
    .wonTricksRow{ display:flex; align-items:flex-start; gap:12px; margin-top:8px; }

    /* Deal & swap animations ðŸ”§ */
    .fly-in{
      animation: flyIn .4s cubic-bezier(.2,.9,.2,1) both;
      will-change: transform, opacity;
    }
    .fly-out{
      animation: flyOut .35s cubic-bezier(.4,.0,.2,1) both;
      transform-origin: center;
      will-change: transform, opacity;
    }
    @keyframes flyIn{
      from { transform: translate3d(0,-18px,0) scale(.97); opacity: 0; }
      to   { transform: translate3d(0,0,0) scale(1);    opacity: 1; }
    }
    @keyframes flyOut{
      from { transform: translate3d(0,0,0) scale(1); opacity: 1; }
      to   { transform: translate3d(0,-24px,0) scale(.72) rotate(-8deg); opacity: 0; }
    }
    /* play animation clone (card flying to table) */
    .playClone{
      position:fixed; z-index:9999; pointer-events:none; border-radius:14px; box-shadow: 0 18px 40px rgba(0,0,0,.45);
      transition: transform .45s cubic-bezier(.2,.9,.2,1), opacity .35s ease;
      transform-origin: center center;
      will-change: transform, opacity;
      backface-visibility: hidden;
    }
    .foldFly{
      position:fixed;
      z-index:9999;
      pointer-events:none;
      border-radius:10px;
      box-shadow: 0 18px 40px rgba(0,0,0,.45);
      animation: foldFlyOut .6s cubic-bezier(.2,.9,.2,1) forwards;
      transform-origin: center center;
      will-change: transform, opacity;
    }
    @keyframes foldFlyOut{
      from{ transform: translate3d(0,0,0) rotate(0deg); opacity:1; }
      to{ transform: translate3d(var(--fold-x, 0px), var(--fold-y, 140px), 0) rotate(var(--fold-rot, 0deg)); opacity:0; }
    }

    /* incoming-card sparkle */
    .fly-in::after{
      content: ''; position: absolute; left: 50%; top: 20%; transform: translateX(-50%) translateY(-10%);
      width: 10px; height: 10px; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,255,255,.95) 0%, rgba(255,255,255,.6) 30%, rgba(255,255,255,0) 60%);
      opacity: 0; pointer-events:none; mix-blend-mode: screen;
      animation: sparkle 700ms cubic-bezier(.2,.9,.2,1) forwards;
    }
    @keyframes sparkle{
      0% { transform: translateX(-50%) translateY(-10%) scale(.4); opacity: 0; }
      40% { transform: translateX(-50%) translateY(-20%) scale(1.4); opacity: .98; }
      100% { transform: translateX(-50%) translateY(-40%) scale(1.8); opacity: 0; }
    }

    /* pop animation for trick-winner pill */
    .pill.trick-winner.pop{ animation: popIn 380ms cubic-bezier(.2,.85,.25,1); }
    @keyframes popIn{
      0%{ transform: translate3d(0,0,0) scale(.94); opacity:0; }
      55%{ transform: translate3d(0,0,0) scale(1.02); opacity:1; }
      100%{ transform: translate3d(0,0,0) scale(1); }
    }
    /* Responsive tweaks for iPhone / narrow screens */
    @media (max-width: 640px){
      :root{ --cardW: 60px; }
      header{ padding:10px 12px; }
      main{ padding:12px; }
      .panel .hd{ padding:10px 12px; }
      .panel .bd{ padding:12px; }
      .tableArea{ gap:10px; }
      .trickArea{ gap:8px; }
      .trickInfoRow{ gap:8px; }
      .trickPlayRow{ gap:8px; }
      .hand{ gap:8px; }
      .row2{ gap:8px; }
      .scoreboard{
        gap:6px;
        --trickChipW: clamp(18px, 7vw, 32px);
        --trickChipH: clamp(26px, 9vw, 44px);
        --trickChipGap: clamp(3px, 1.3vw, 6px);
        --trickInnerFont: clamp(10px, 3vw, 13px);
      }
      .playerRow{
        padding:8px 10px;
        min-height:0;
        gap:10px;
        align-items:flex-start;
      }
      .badge{ padding:4px 6px; font-size:11px; }
      .totalScore{
        min-width:68px;
        padding:6px 8px;
        font-size:12px;
        border-radius:12px;
      }
      .totalScore .scoreValue{ font-size:15px; margin-left:4px; }
      .totalScore .scoreLabel{ font-size:11px; }
    }
    /* Responsive tweaks for narrow/phone screens */
    @media (max-width: 520px){
      :root{ --cardW: 56px; }
      header{ padding:10px 12px }
      .title div{ font-size:14px }
      .pill{ padding:6px 8px; font-size:12px }
      .cardBtn{ width: var(--cardW); height: calc(var(--cardW) * 1.45); }
      .cardFace{ width: var(--cardW); height: calc(var(--cardW) * 1.35); }
      .trickSlot{ min-width: var(--cardW); }
      .pill.trick-winner .miniCard{ width:40px; height:48px }
      .totalScore{ min-width:64px; padding:6px 8px; font-size:12px }
      .wonTrick .miniCard:last-child{ transform: translateY(-20px); }
    }
    @media (max-width: 360px){
      :root{ --cardW: 48px; }
      .scoreboard{
        --trickChipW: clamp(16px, 8.5vw, 22px);
        --trickChipH: clamp(22px, 12vw, 32px);
        --trickChipGap: 3px;
        --trickInnerFont: clamp(9px, 3vw, 11px);
      }
      .pill.trick-winner{ padding:7px 10px }
      .pill.trick-winner .miniCard{ width:34px; height:40px }
      .title div{ font-size:13px }
      .scoreboard .playerRow{ padding:8px }
      .hand{ gap:8px }
    }

    /* Auto-pass small ring */
    .autoPassRing{
      width:26px; height:26px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:12px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.06); color:var(--muted);
      box-shadow: 0 6px 12px rgba(0,0,0,.3);
    }
    /* notifier styles (now in header) */
    #notifier{
      display:none;
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid var(--stroke);
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }
    #notifierIcon{ font-size:20px; }
    #notifierTitle{ font-size:15px }
    /* notifier action visually present but non-interactive; actions belong in main UI */
    #notifierAction{ background: rgba(124,92,255,.14); border:1px solid rgba(124,92,255,.28); color:var(--text); display:none; pointer-events:none; }
    @media (max-width:720px){ #notifier{ gap:10px; } #notifierAction{ display:none } }
    @media (max-width:640px){ .tableArea{ padding-bottom:24px; } }
    /* lobby settings */
    .settingsCard{
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(124,92,255,.10), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
    }
    .settingsHeader{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:6px 6px 10px 6px;
      cursor:pointer;
      user-select:none;
    }
    .settingsCard.collapsed .settingsBody{ display:none; }
    .settingRow{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      align-items:center;
      padding:10px 8px;
      border-radius:12px;
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.04);
    }
    .settingRow + .settingRow{ margin-top:10px; }
    .settingLabel{ font-weight:800; }
    .settingMeta{ color:var(--muted); font-size:12px; margin-top:4px; }
    .settingValue{
      font-weight:900; font-size:14px; padding:6px 10px;
      border-radius:10px; background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.08);
      min-width:56px; text-align:center;
    }
    .settingControls{ display:flex; align-items:center; gap:10px; }
    .settingRow input[type="range"]{ width:160px; max-width:60vw; accent-color: var(--accent); }
    .settingToggle{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10);
      font-weight:800; font-size:12px; color:var(--muted);
    }
    .settingToggle input{ width:18px; height:18px; }
    /* mode + multiplayer */
    .modeCard{
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(62,226,138,.10), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
    }
    .modeRow{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .modeBtn{
      padding:8px 12px; border-radius:12px; font-weight:800;
      border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.06);
      cursor:pointer; color:var(--muted);
    }
    .modeBtn.active{
      color:var(--text);
      border-color: rgba(124,92,255,.45);
      background: rgba(124,92,255,.22);
    }
    .mpCard{
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
      box-shadow: var(--shadow);
    }
    .mpRow{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .mpCode{ min-width:120px; text-transform:uppercase; letter-spacing:.8px; }
    .mpStatus{ font-size:12px; color:var(--muted); }
    .mpStatus.mpHint{
      padding:6px 10px;
      border-radius:10px;
      background: rgba(255,255,255,.04);
      border:1px dashed var(--stroke);
      font-style: italic;
    }
    .mpDivider{
      height:1px;
      background: var(--stroke);
      margin:2px 0 6px;
    }
    .logCard{
      border:1px solid var(--stroke);
      border-radius:16px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .logHeader{
      display:flex; align-items:center; gap:8px;
      padding:10px 12px;
      cursor:pointer;
      border-bottom:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
    }
    .logCaret{
      display:inline-block; width:14px; text-align:center;
      transition: transform .12s ease;
    }
    .logCard.collapsed .logCaret{ transform: rotate(-90deg); }
    .logBody{ padding:12px; display:block; }
    .logCard.collapsed .logBody{ display:none; }
    .logList{
      max-height:240px;
      overflow-y:auto;
      display:flex;
      flex-direction:column;
      gap:8px;
      padding-right:4px;
    }
    .gameLog{
      border:1px solid var(--stroke);
      border-radius:14px;
      background: rgba(0,0,0,.16);
      padding:8px 10px;
    }
    .gameLog summary{
      list-style:none;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .gameLog summary::-webkit-details-marker{ display:none; }
    .gameTitle{ font-weight:800; font-size:13px; }
    .gameMeta{ font-size:12px; color:var(--muted); }
    .gameHands{ margin-top:8px; display:flex; flex-direction:column; gap:8px; }
    .handLog{
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
      padding:6px 10px;
    }
    .handLog summary{
      list-style:none;
      cursor:pointer;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .handLog summary::-webkit-details-marker{ display:none; }
    .handTitle{ font-weight:800; font-size:13px; }
    .handScores{ font-size:12px; color:var(--muted); }
    .scoreMiniTable{
      display:grid;
      gap:2px;
    }
    .scoreMiniRow{
      display:grid;
      gap:6px;
      align-items:center;
    }
    .scoreMiniCell{
      text-align:center;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
    }
    .scoreMiniRow.scores .scoreMiniCell{
      font-weight:800;
      color:var(--text);
    }
    .handPlays{ margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .trickLog{
      border-top:1px dashed var(--stroke);
      padding-top:6px;
    }
    .trickLog:first-child{ border-top:none; padding-top:0; }
    .playLine{
      display:flex; align-items:center; justify-content:space-between;
      gap:8px;
      font-size:12px;
      color:var(--muted);
    }
    .chatBlock{
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
      padding:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      margin:12px 0 0;
    }
    .chatHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      font-weight:800;
      font-size:13px;
    }
    .chatList{
      max-height:160px;
      overflow-y:auto;
      display:flex;
      flex-direction:column;
      gap:6px;
      padding-right:4px;
    }
    .chatMessage{
      display:flex;
      flex-direction:column;
      gap:2px;
      padding:6px 8px;
      border-radius:10px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.06);
    }
    .chatRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .chatMeta{
      font-size:11px;
      color:var(--muted);
      display:flex;
      gap:6px;
      align-items:center;
    }
    .chatText{
      font-size:13px;
      color:var(--text);
      word-break:break-word;
      flex:1;
    }
    .chatHeart{
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:12px;
      color:#ff9ab4;
      opacity:.9;
      white-space:nowrap;
    }
    .chatHeart.hidden{ display:none; }
    .chatHeart.liked{ color:#ff6f97; }
    .chatComposer{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .chatComposer input{
      flex:1;
      min-width:0;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.1);
      background: rgba(255,255,255,.04);
      color:var(--text);
      font-size:16px;
    }
    .chatComposer input::placeholder{ color:var(--muted); }
    .connectionStatus{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-weight:700;
    }
    .statusDot{
      width:8px;
      height:8px;
      border-radius:999px;
      background: var(--good);
      box-shadow: 0 0 10px rgba(62,226,138,.45);
      display:inline-block;
    }
    .statusSpinner{
      width:12px;
      height:12px;
      border-radius:999px;
      border:2px solid rgba(124,92,255,.35);
      border-top-color: rgba(124,92,255,.9);
      animation: spin 1s linear infinite;
      display:inline-block;
    }
    @keyframes spin{
      from{ transform: rotate(0deg); }
      to{ transform: rotate(360deg); }
    }
    .reconnectOverlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(6,9,18,.55);
      backdrop-filter: blur(6px);
      z-index: 60;
      text-align:center;
    }
    .reconnectCard{
      background: rgba(12,18,40,.92);
      border:1px solid var(--stroke);
      border-radius:20px;
      padding:24px 20px;
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      max-width:320px;
    }
    .fullscreenPopup{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(6,9,18,0);
      backdrop-filter: blur(0px);
      z-index: 70;
      opacity:0;
      pointer-events:none;
      overflow:hidden;
    }
    .fullscreenPopup.show,
    .fullscreenPopup.hiding{ display:flex; }
    .fullscreenPopup.show{
      pointer-events:auto;
      animation: popupBackdropIn 0.4s ease-out forwards;
    }
    .fullscreenPopup.hiding{
      pointer-events:none;
      animation: popupBackdropOut 0.45s ease-in forwards;
    }
    .confetti{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0;
      transition: opacity .2s ease;
    }
    .fullscreenPopup.confettiOn .confetti{ opacity:1; }
    .confettiPiece{
      position:absolute;
      width:8px;
      height:14px;
      border-radius:2px;
      background: var(--confetti-color, #fff);
      opacity:.9;
      transform: translate3d(0,-20%,0) rotate(0deg);
      animation: confettiFall var(--confetti-duration, 3s) var(--confetti-delay, 0s) ease-in forwards;
    }
    .popupCard{
      padding:28px 26px;
      border-radius:20px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(12,18,40,.95);
      box-shadow: var(--shadow);
      text-align:center;
      min-width:220px;
      opacity:0;
      transform: scale(.95);
      filter: blur(4px);
    }
    .fullscreenPopup.show .popupCard{
      animation: popupCardIn 0.38s ease-out forwards;
    }
    .fullscreenPopup.hiding .popupCard{
      animation: popupCardOut 0.36s ease-in forwards;
    }
    .popupCard.danger{
      border-color: rgba(255,92,122,.45);
      background: rgba(40,10,20,.92);
    }
    .popupCard.good{
      border-color: rgba(62,226,138,.45);
      background: rgba(10,40,24,.92);
    }
    .popupTitle{
      font-weight:900;
      font-size:24px;
      letter-spacing:.6px;
    }
    .popupSubtitle{
      margin-top:8px;
      font-size:13px;
      color:var(--muted);
    }
    .popupCard.danger .popupSubtitle{ color:#ffd0d8; }
    .popupCard.good .popupSubtitle{ color:#baf5d4; }
    @keyframes popupBackdropIn{
      from{ opacity:0; backdrop-filter: blur(0px); background: rgba(6,9,18,0); }
      to{ opacity:1; backdrop-filter: blur(8px); background: rgba(6,9,18,.7); }
    }
    @keyframes popupBackdropOut{
      from{ opacity:1; backdrop-filter: blur(8px); background: rgba(6,9,18,.7); }
      to{ opacity:0; backdrop-filter: blur(0px); background: rgba(6,9,18,0); }
    }
    @keyframes popupCardIn{
      from{ transform: scale(.92); opacity:0; filter: blur(8px); }
      to{ transform: scale(1); opacity:1; filter: blur(0px); }
    }
    @keyframes popupCardOut{
      from{ transform: scale(1); opacity:1; filter: blur(0px); }
      to{ transform: scale(.96); opacity:0; filter: blur(8px); }
    }
    @keyframes confettiFall{
      0%{ transform: translate3d(0,-20%,0) rotate(0deg); opacity:0; }
      15%{ opacity:1; }
      100%{ transform: translate3d(0,120vh,0) rotate(var(--confetti-rot, 360deg)); opacity:0; }
    }
    .lobbyList{ display:flex; flex-direction:column; gap:6px; }
    .lobbyPlayer{
      padding:8px 10px;
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
      font-size:13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .roomListSection{ display:flex; flex-direction:column; gap:6px; }
    .roomList{ display:flex; flex-direction:column; gap:8px; }
    .roomCard{
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
      padding:10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .roomBadgeRow{
      display:flex;
      align-items:center;
      gap:6px;
      flex-wrap:wrap;
    }
    .roomMeta{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
      min-width:0;
      flex: 1 1 auto;
    }
    .roomBadges{
      display:flex;
      align-items:center;
      gap:6px;
      flex-wrap:wrap;
      justify-content:flex-end;
      min-width:0;
    }
    .roomActions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-left:auto;
      justify-content:flex-end;
    }
    .roomButtons{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .roomEnterBtn:not(:disabled){
      background: linear-gradient(180deg, #23b45d, #14904a);
      border-color: rgba(26,160,79,.65);
      color: #eafff0;
      box-shadow: 0 12px 26px rgba(26,160,79,.24);
    }
    .roomEnterBtn:not(:disabled):hover{
      transform: translateY(-1px);
      box-shadow: 0 16px 32px rgba(26,160,79,.3);
    }
    .roomEnterBtn:not(:disabled):active{
      transform: translateY(0);
      box-shadow: 0 10px 22px rgba(26,160,79,.24);
    }
    .roomTitle{ font-weight:800; letter-spacing:.6px; }
    .roomCount{ font-size:12px; color:var(--muted); }
    .pwaPrompt{
      position: fixed;
      inset: 0;
      display: none;
      align-items: flex-end;
      justify-content: center;
      padding: 16px;
      background: rgba(6,9,18,.6);
      backdrop-filter: blur(6px);
      z-index: 40;
    }
    .pwaCard{
      width: min(560px, 100%);
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: linear-gradient(160deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .pwaTitle{ font-weight: 900; font-size: 16px; }
    .pwaSteps{ display:flex; flex-direction:column; gap:6px; }
    .pwaStep{ display:flex; gap:8px; align-items:flex-start; font-size:13px; color:var(--muted); }
    .pwaStepNum{
      width:20px; height:20px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      background: rgba(124,92,255,.18);
      border:1px solid rgba(124,92,255,.35);
      color: var(--text);
      font-weight: 800;
      font-size: 11px;
      flex: 0 0 auto;
    }
    .pwaActions{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; }
    .pwaStatus{ font-size:12px; color:var(--muted); }
    .roomTurnBadge{
      padding:4px 8px;
      border-radius:999px;
      background: rgba(255,235,140,.35);
      border:1px solid rgba(255,215,120,.6);
      color:#ffffff;
      font-size:11px;
      font-weight:700;
      text-shadow: 0 1px 2px rgba(0,0,0,.25);
    }
    .roomLobbyCard{
      border:1px solid var(--stroke);
      border-radius:12px;
      background: rgba(0,0,0,.18);
      padding:10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .lobbyChatSlot{ margin-top:6px; }
    .roomLobbyTitle{ font-weight:800; }
    /* winner banner */
    #winnerBanner{
      border:1px solid rgba(255,230,140,.12);
      background: linear-gradient(120deg, rgba(255,235,160,.12), rgba(124,92,255,.08));
      box-shadow: 0 18px 44px rgba(245,190,40,.12);
    }
    #winnerIcon{
      width:44px; height:44px; border-radius:10px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(255,235,160,.25);
      border:1px solid rgba(255,230,140,.25);
      font-size:20px;
    }
    .dingBadge{
      padding:4px 8px; border-radius:10px;
      border:1px solid rgba(255,92,122,.35);
      background: rgba(255,92,122,.12);
      font-size:12px; color:#ffd6de; display:inline-flex; gap:6px; align-items:center;
    }
    .winsBadge{
      padding:4px 8px; border-radius:10px;
      border:1px solid rgba(255,215,130,.35);
      background: rgba(255,215,130,.12);
      font-size:12px; color:#ffe3b8; display:inline-flex; gap:6px; align-items:center;
    }
